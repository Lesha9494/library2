{% extends 'base.html.twig' %}

{% block title %}Читатели
{% endblock %}

{% block body %}
	<div class="container">
		<div class="header">
			<h1>Читатели</h1>
			<a href="{{ path('app_reader_new') }}" class="btn-new">+ Новый читатель</a>
		</div>

		{% if readers|length > 0 %}
			<table class="reader-table">
				<thead>
					<tr>
						<th>ID</th>
						<th>ФИО</th>
						<th>Номер билета</th>
						<th>Контакты</th>
						<th>Email</th>
						<th>Книг на руках</th>
						<th>Действия</th>
					</tr>
				</thead>
				<tbody>
					{% for reader in readers %}
						<tr>
							<td>{{ reader.id }}</td>
							<td>{{ reader.fullName }}</td>
							<td>{{ reader.ticketNumber }}</td>
							<td>{{ reader.contacts }}</td>
							<td>{{ reader.email ? reader.email : '-' }}</td>
							<td>
								{% set activeLoans = 0 %}
								{% for loan in reader.loans %}
									{% if not loan.returnDate %}
										{% set activeLoans = activeLoans + 1 %}
									{% endif %}
								{% endfor %}
								{{ activeLoans }}
							</td>
							<td class="actions">
								<a href="{{ path('app_reader_show', {'id': reader.id}) }}" class="btn-view">Просмотр</a>
								<a href="{{ path('app_reader_edit', {'id': reader.id}) }}" class="btn-edit">Изменить</a>
							</td>
						</tr>
					{% endfor %}
				</tbody>
			</table>
		{% else %}
			<div class="empty-state">
				<p>Читателей не найдено</p>
				<a href="{{ path('app_reader_new') }}" class="btn-new">Добавить первого читателя</a>
			</div>
		{% endif %}
	</div>

	<style>
		.container {
			padding: 20px;
		}

		.header {
			display: flex;
			justify-content: space-between;
			align-items: center;
			margin-bottom: 20px;
		}

		h1 {
			color: #333;
		}

		.btn-new {
			background: #2196F3;
			color: white;
			padding: 10px 15px;
			border-radius: 4px;
			text-decoration: none;
		}

		.btn-new:hover {
			background: #1976D2;
		}

		.reader-table {
			width: 100%;
			border-collapse: collapse;
			background: white;
		}

		.reader-table th {
			background: #f5f5f5;
			padding: 12px;
			text-align: left;
			border-bottom: 2px solid #ddd;
			font-weight: bold;
		}

		.reader-table td {
			padding: 10px;
			border-bottom: 1px solid #eee;
		}

		.reader-table tr:hover {
			background: #f9f9f9;
		}

		.actions {
			display: flex;
			gap: 5px;
		}

		.btn-view,
		.btn-edit {
			padding: 5px 10px;
			border-radius: 3px;
			text-decoration: none;
			font-size: 14px;
		}

		.btn-view {
			background: #4CAF50;
			color: white;
		}

		.btn-view:hover {
			background: #45a049;
		}

		.btn-edit {
			background: #FF9800;
			color: white;
		}

		.btn-edit:hover {
			background: #F57C00;
		}

		.empty-state {
			text-align: center;
			padding: 40px;
			background: white;
			border-radius: 5px;
			margin-top: 20px;
		}

		.empty-state p {
			margin-bottom: 20px;
			color: #666;
		}
	</style>
{% endblock %}
